:root {
  --bg: #0f1220;
  --panel: #1a1f35;
  --muted: #8a93b2;
  --accent: #6ee7ff;
  --accent2: #a78bfa;
  --good: #34d399;
  --bad: #f87171;
  --warn: #fbbf24;
  --white: #e5e7f2;
}
* { box-sizing: border-box; }
html, body { height: 100%; }
body {
  margin: 0;
  background: radial-gradient(1200px 800px at 30% 20%, #151936, var(--bg));
  color: var(--white);
  font: 14px/1.4 system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Arial, "Apple Color Emoji", "Segoe UI Emoji";
  display: grid;
  grid-template-columns: 1fr 360px;
  gap: 12px;
  padding: 12px;
}
header {
  grid-column: 1 / -1;
  display: flex; align-items: center; justify-content: space-between;
  padding: 8px 12px; background: #121527a8; backdrop-filter: blur(4px);
  border: 1px solid #ffffff10; border-radius: 12px;
}
header h1 { font-size: 16px; font-weight: 600; margin: 0; color: var(--accent); }
#gameWrap {
  position: relative;
  border-radius: 12px; overflow: hidden; border: 1px solid #ffffff14;
  box-shadow: 0 10px 30px #0008;
  background: #0b0e1d;
  aspect-ratio: 16 / 9;
  width: 100%; height: auto;
}
#gameCanvas {
  width: 100%; height: 100%; display: block;
  cursor: none; /* hide default cursor; we draw a crosshair */
}
#hud {
  position: absolute; inset: 0; pointer-events: none; padding: 12px;
  display: flex; flex-direction: column; gap: 8px; font-size: 13px;
}
.hud-row { display: flex; gap: 8px; }
.pill { pointer-events: auto; padding: 6px 10px; border-radius: 999px; background: #11152a; border: 1px solid #ffffff14; }
.bar { height: 10px; width: 180px; border-radius: 8px; background: #2a304d; overflow: hidden; border: 1px solid #ffffff14; }
.bar > div { height: 100%; background: linear-gradient(90deg, #34d399, #06b6d4); width: 50%; }
.corner { position: absolute; }
#topLeft { top: 8px; left: 8px; }
#topRight { top: 8px; right: 8px; }
#bottomLeft { bottom: 8px; left: 8px; }
#bottomRight { bottom: 8px; right: 8px; }

/* Side panel */
aside { display: grid; gap: 12px; align-content: start; }
.card { background: var(--panel); border: 1px solid #ffffff14; border-radius: 14px; padding: 12px; box-shadow: 0 6px 18px #0006; }
.card h2 { margin: 0 0 8px; font-size: 14px; color: var(--accent2); }
.statgrid { display: grid; grid-template-columns: 1fr auto; gap: 6px 8px; align-items: center; }
.muted { color: var(--muted); }

/* Inventory */
.inv-grid { display: grid; grid-template-columns: repeat(5, 1fr); gap: 8px; }
.slot { aspect-ratio: 1/1; border: 2px solid #ffffff20; border-radius: 10px; display: grid; place-items: center; color: #b6c0ff; background: #12162b; position: relative; }
.slot .small { position: absolute; bottom: 4px; right: 6px; font-size: 10px; color: var(--muted); }
.slot.equipped { border-style: solid; border-color: var(--accent2); }
#equipment .slot {
  position: relative;
  display: grid;
  place-items: center;
  overflow: hidden;
}

/* Inventory: fixed 3 rows × 5 cols grid */
#inventory {
  display: grid;
  grid-template-columns: repeat(5, 64px);
  grid-auto-rows: 64px;
  gap: 8px;
  width: calc(5 * 64px + 4 * 8px);  /* 5 cols */
  height: calc(3 * 64px + 2 * 8px); /* 3 rows */
  padding: 6px;
  box-sizing: content-box;
  overflow: hidden; /* panel never grows */
}
#inventory .slot { position: relative; width: 64px; height: 64px; }
#inventory .slot.empty {
  border: 1px dashed #2b3650;
  background: repeating-linear-gradient(
    45deg, #0f1629, #0f1629 6px, #0d1322 6px, #0d1322 12px
  );
  opacity: 0.9;
}
#inventory .slot img { width:100%; height:100%; object-fit:contain; image-rendering: crisp-edges; }


/* Ensure icons fit nicely */
#inventory .slot img {
  width: 100%;
  height: 100%;
  object-fit: contain;
  image-rendering: crisp-edges;
}
 button {
          color: #a78bfa;
        }
/* Fixed-size equipment grid to prevent huge squares */
#equipment {
  display: grid;
  grid-template-columns: repeat(5, 64px);
  grid-auto-rows: 64px;
  gap: 8px;
}

#equipment .slot {
  width: 64px;
  height: 64px;
  aspect-ratio: auto; /* cancel the global .slot aspect ratio */
}


#equipment .slot img {
  width: 100%;
  height: 100%;
  object-fit: contain;
  image-rendering: crisp-edges;
}

#equipment .slot .caption {
  position: absolute;
  left: 4px;
  right: 4px;
  bottom: 2px;
  font-size: 10px;
  text-align: center;
  color: #cbd5e1;
  background: rgba(0,0,0,0.30);
  border-radius: 4px;
  padding: 2px 4px;
}

#equipment .slot .placeholder {
  font-size: 12px;
  color: #94a3b8;
  opacity: 0.85;
}


/* Item imagery + actions */
.slot.item { cursor: pointer; }
.slot img { width: 70%; height: 70%; object-fit: contain; filter: drop-shadow(0 1px 1px #0006); }
.slot .actions { position: absolute; top: 4px; right: 4px; display: flex; gap: 4px; opacity: 0; transition: opacity .15s; }
.slot:hover .actions { opacity: 1; }
.mini { pointer-events: auto; cursor: pointer; border: 1px solid #ffffff30; background: #0b0f24; color: #cfe4ff; height: 20px; padding: 0 6px; border-radius: 6px; font-size: 11px; }
.mini.trash { border-color: #ff6b6b55; color: #ffd7d7; }

/* Tooltip */
#tooltip { position: fixed; z-index: 1000; display: none; padding: 10px 12px; background: #0f142e; border: 1px solid #ffffff20; border-radius: 10px; box-shadow: 0 8px 24px #0008; max-width: 320px; }
#tooltip .tt-name { font-weight: 700; margin-bottom: 4px; color: #e3e7ff; }
#tooltip ul { margin: 6px 0 0 16px; }

/* Rarity frames and deltas */
.rarity-common    { border-color: #4b5563 !important; }
.rarity-uncommon  { border-color: #10b981 !important; }
.rarity-rare      { border-color: #3b82f6 !important; }
.rarity-epic      { border-color: #a78bfa !important; }
.rarity-legendary { border-color: #f59e0b !important; }

.tt-rare    { color:#93c5fd; }
.tt-epic    { color:#c4b5fd; }
.tt-legend  { color:#fcd34d; }

.delta { margin-top:6px; border-top:1px solid #ffffff14; padding-top:6px; }
.delta-row { display:flex; justify-content:space-between; }
.delta .pos { color:#34d399; }
.delta .neg { color:#f87171; }
.delta .neu { color:#94a3b8; }

.btn { cursor: pointer; user-select: none; padding: 8px 10px; background: #12162b; border: 1px solid #ffffff22; border-radius: 10px; transition: transform .02s ease; }
.btn:hover { border-color: #ffffff44; }
.btn:active { transform: translateY(1px); }
.btn.primary { background: linear-gradient(180deg, #1b2141, #141a36); border-color: #6ee7ff66; color: #c7f7ff; }


.kbd { display:inline-grid; place-items:center; min-width: 24px; height: 24px; padding: 0 6px; border: 1px solid #ffffff24; border-bottom-width: 3px; border-radius: 6px; background:#0c1022; color:#c8d2ff; font-weight:600; margin-right:6px; font-size:12px; }
ul { margin: 6px 0 0 18px; }
code { color: #b6f; }


/* === Scope modal shop styles to the overlay only === */
#shopOverlay #shopCard{
  width: 620px !important;
  height: 460px !important;
  max-width: 94vw !important;
  max-height: 90vh !important;
  display: flex;
  flex-direction: column;
}

#shopOverlay #shopList{
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(110px, 1fr)); /* square tiles */
  gap: 8px;
  flex: 1 1 auto;
  min-height: 0;
  overflow-y: auto;
  padding-right: 4px;
}

/* Make each offer a square, fully clickable card */
#shopOverlay .shop-card{
  aspect-ratio: 1 / 1;
	   width: 100%;               /* fill the grid track */
	  height: auto;

  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  gap: 6px;
  padding: 1px;
  border: 1px solid #2b3650;
  border-radius: 8px;
  background: #0f1629;
  text-align: center;
  cursor: pointer;
}
#shopOverlay .shop-card.disabled{
  opacity: .45; filter: grayscale(.7); cursor: not-allowed; outline: none;
}
#shopOverlay .shop-card .title{ font-size:12px; font-weight:600; }
#shopOverlay .shop-card .sub{ font-size:11px; opacity:.8; }
#shopOverlay .shop-card .price{ font-size:12px; opacity:.9; }

/* === Compact shop grid: small fixed tracks === */
#shopOverlay{
  --tile: 92px;   /* try 92px, 88px, or 84px to fit more */
  --gap: 6px;
}

#shopOverlay #shopList{
  display: grid;
  grid-template-columns: repeat(auto-fit, var(--tile)); /* fixed track width */
  justify-content: start;                               /* no huge right gap */
  gap: var(--gap);
  overflow-y: auto;
  padding-right: 2px;
}


/* Prevent earlier rules from stretching tiles */
#shopOverlay .shop-card{ aspect-ratio: auto !important; }

/* Shop tile hover/focus states */
#shopOverlay .shop-card{
  border: 1px solid #2b3650;                 /* base */
  transition: border-color .12s ease, box-shadow .12s ease, transform .06s ease;
}
#shopOverlay .shop-card:hover{
  border-color: #3b82f6;                     /* accent on hover */
  box-shadow: 0 0 0 2px rgba(59,130,246,.25) inset;
}
#shopOverlay .shop-card:active{
  transform: translateY(1px) scale(.99);     /* subtle press feedback */
}

/* Keyboard accessibility */
#shopOverlay .shop-card:focus-visible{
  outline: none;
  border-color: #60a5fa;
  box-shadow: 0 0 0 2px rgba(96,165,250,.35) inset;
}

/* Don’t react if disabled/sold */
#shopOverlay .shop-card.disabled,
#shopOverlay .shop-card.disabled:hover,
#shopOverlay .shop-card.disabled:focus-visible{
  border-color: #2b3650;
  box-shadow: none;
  transform: none;
  cursor: not-allowed;
}

/* === Compact sidebar so it fits next to the canvas === */
:root{
  --slot: 56px;   /* was 64px */
  --gap: 6px;     /* was 8px */
}

/* Inventory: fixed 3×5 grid */
#inventory{
  grid-template-columns: repeat(5, var(--slot));
  grid-auto-rows: var(--slot);
  gap: var(--gap);
  width: calc(5 * var(--slot) + 4 * var(--gap));
  height: calc(3 * var(--slot) + 2 * var(--gap));
}
#inventory .slot{ width: var(--slot); height: var(--slot); }

/* Equipment: fixed 5 slots */
#equipment{
  grid-template-columns: repeat(5, var(--slot));
  grid-auto-rows: var(--slot);
  gap: var(--gap);
}
#equipment .slot{ width: var(--slot); height: var(--slot); }
